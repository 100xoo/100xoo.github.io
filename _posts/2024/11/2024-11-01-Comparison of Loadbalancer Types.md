---
layout: single
title: 로드밸런서 종류 비교(L4, L7 종류와 특징)
categories: Infra
tags: [Loadbalancer]
toc: True
---

## Layer 4 Loadbalancer
L4 로드밸런서는 OSI 모델의 **4계층(전송 계층)**에서 동작하여 IP 주소와 포트를 기반으로 트래픽을 분산하는 방식

### L4 로드밸런싱 주요 특징

1. **IP 및 포트 기반 라우팅**
   - L4 로드밸런서는 패킷의 **출발지 IP, 목적지 IP, 포트 번호**와 같은 전송 계층 정보를 사용하여 트래픽을 분산
   - 애플리케이션 레벨의 상세 정보에는 접근하지 않고, 전송 계층 정보만을 사용하여 빠르게 트래픽을 처리

2. **프로토콜 지원**
   - TCP와 UDP와 같은 전송 계층 프로토콜을 주로 사용하며, HTTP, HTTPS 등의 애플리케이션 레벨 프로토콜에 대해 추가 기능은 제공하지 않음

3. **빠른 처리 속도**
   - 데이터 페이로드(payload)를 검사하지 않으므로 L7 로드밸런서보다 **처리 속도가 빠르고 리소스 소모가 적음**.
   - 네트워크 레벨에서의 패킷 처리를 하기 때문에 성능이 중요한 경우에 유리함

4. **클라이언트와 서버의 연결 유지**
   - 클라이언트와 서버 간의 **세션을 유지**하며, 동일 클라이언트의 요청이 항상 같은 서버로 전달되도록 설정 가능 (예: IP 기반 세션 고정)

5. **확장성**
   - 트래픽을 여러 서버로 분산시켜 **서버 부하를 줄이고, 가용성을 높임**.
   - 서버가 추가되거나 감소할 때 동적으로 분산 정책을 조정할 수 있음.

6. **SSL 오프로딩 미지원**
   - L4 로드밸런서는 주로 TCP/UDP 레벨에서 작동하므로 **SSL 오프로딩을 지원 안됨**. 암호화된 트래픽 처리는 L7 로드밸런서가 더 적합

7. **비용 효율성**
   - 하드웨어나 소프트웨어 리소스를 덜 사용하기 때문에 L7 로드밸런서보다 상대적으로 **비용이 저렴**하며, 소규모 네트워크 환경에도 적합

8. **간단한 설정 및 관리**
   - 복잡한 애플리케이션 정보가 필요 없으므로 **설정이 상대적으로 간단**하며, 고급 트래픽 분산 정책이 필요하지 않은 경우에 쉽게 적용할 수 있음

### 주 사용 사례

- **웹 서버의 기본 부하 분산**
- **동일한 서비스가 여러 서버에 제공될 때 단순 부하 분산을 원하는 경우**
- **SSL 암호화가 필요 없고 빠른 트래픽 처리가 요구되는 환경**

L4 로드밸런서는 고속 트래픽 처리와 비용 효율성을 필요로 하는 경우 적합하며, L7보다 간단한 트래픽 관리가 필요할 때 사용

---

## Layer 7 Loadbalancer
L7 로드밸런서는 OSI 모델의 **7계층(애플리케이션 계층)**에서 동작하며, 애플리케이션 계층 정보를 기반으로 트래픽을 정교하게 분산

### L7 로드밸런싱 주요 특징

1. **애플리케이션 계층 정보 기반 라우팅**
   - URL, 쿠키, HTTP 헤더, 클라이언트 IP와 같은 **애플리케이션 레벨의 정보**를 분석하여 트래픽을 분배
   - 트래픽의 내용에 따라 특정 서버로 요청을 분배할 수 있어 정교한 트래픽 관리 가능

2. **프로토콜 지원**
   - HTTP/HTTPS와 같은 애플리케이션 레벨 프로토콜을 지원하며, 다양한 애플리케이션 정보를 기반으로 라우팅 가능
   - HTTP 메서드(GET, POST 등)나 쿠키, 세션 정보 등 다양한 요소를 기준으로 분산 정책을 설정할 수 있음.

3. **SSL 오프로딩**
   - SSL 인증서를 관리하고 암호화 트래픽을 해제하여 서버에 전달하므로, 서버의 부담을 줄여줌.
   - HTTPS 트래픽을 해제하고 분석하여 트래픽을 분산할 수 있으므로 보안 및 성능을 동시에 강화할 수 있음.

4. **정교한 로드밸런싱 정책**
   - 애플리케이션 요구사항에 따라 다양한 조건을 설정하여 트래픽을 특정 서버에 분배 가능
   - 예를 들어 URL 경로에 따라 이미지 서버, API 서버 등으로 분리하여 트래픽을 분배 가능

5. **세션 지속성 (Sticky Session)**
   - 클라이언트가 동일한 세션 동안 동일한 서버와 연결을 유지할 수 있게 하여 세션 정보를 지속적으로 관리할 수 있음.
   - 세션 지속성은 주로 쿠키 기반이나 IP 기반 방식으로 설정

6. **트래픽 분석 및 최적화**
   - 애플리케이션 레벨에서 트래픽을 분석하고, HTTP 압축, 캐싱 등 최적화 작업을 통해 트래픽 효율성을 높일 수 있음.
   - 사용자가 요청하는 리소스의 콘텐츠에 따라 로드밸런싱을 조정할 수 있어 더 나은 사용자 경험을 제공

### 주 사용 사례

- **HTTP/HTTPS 기반 웹 애플리케이션의 부하 분산**
- **API 게이트웨이로서의 역할 수행**
- **정교한 트래픽 분배가 필요한 마이크로서비스 환경**
- **다양한 조건을 기반으로 한 복잡한 트래픽 분산 요구**

---

## L4, L7 비교 테이블

| **로드밸런서 종류**          | **L4 지원** | **L7 지원** | **주요 특징**                                  | **지원 환경**                 |
|-------------------------------|-------------|-------------|------------------------------------------------|--------------------------------|
| **F5 BIG-IP**                 | O           | O           | 고성능, SSL 오프로딩, 고급 정책 설정 가능      | 물리적, 가상, 클라우드         |
| **Citrix ADC (NetScaler)**    | O           | O           | TCP 최적화, SSL 오프로딩, 보안 기능 강화       | 물리적, 가상, 클라우드         |
| **A10 Networks - Thunder**    | O           | O           | DDoS 방어, SSL 오프로딩, 고성능                | 물리적, 가상, 클라우드         |
| **AWS Network Load Balancer** | O           | X           | IP 및 포트 기반 트래픽 분산, Auto Scaling      | AWS 클라우드                   |
| **AWS Application Load Balancer** | X        | O           | HTTP/HTTPS 기반, 다양한 조건 라우팅           | AWS 클라우드                   |
| **Google Cloud NLB**          | O           | X           | TCP/UDP 트래픽 분산, 고정 IP 제공              | GCP 클라우드                   |
| **Google Cloud HTTP(S) LB**   | X           | O           | 글로벌 로드밸런싱, SSL 오프로딩                | GCP 클라우드                   |
| **Microsoft Azure Load Balancer** | O       | X           | TCP/UDP 트래픽 기반 부하 분산                  | Azure 클라우드                 |
| **Microsoft Azure Application Gateway** | X | O       | HTTP/HTTPS 기반, WAF 통합                     | Azure 클라우드                 |
| **Nginx**                     | O           | O           | 오픈소스, TCP/UDP 및 HTTP 라우팅 지원          | 가상 환경, 온프레미스          |
| **HAProxy**                   | O           | O           | 오픈소스, 고가용성, SSL 오프로딩               | 가상 환경, 온프레미스          |
| **Kemp LoadMaster**           | O           | O           | 사용하기 쉬운 인터페이스, SSL 오프로딩         | 물리적, 가상, 클라우드         |
| **Traefik**                   | X           | O           | 컨테이너 네이티브, 자동 동적 설정 지원         | 컨테이너 환경 (Kubernetes 등) |
| **Envoy**                     | X           | O           | 서비스 메시, HTTP/2 및 gRPC 지원               | 컨테이너 환경 (Kubernetes 등) |
| **pfSense**                   | O           | X           | 오픈소스 방화벽, 저비용 솔루션                 | 가상 환경, 온프레미스          |
| **Opnsense**                  | O           | X           | 오픈소스 방화벽, 소규모 네트워크 적합          | 가상 환경, 온프레미스          |
